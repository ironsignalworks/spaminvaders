<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Spam Invaders</title>
<style>
  :root{
    --bg:#c0c0c0; --ink:#000; --accent:#000080; --danger:#800000; --gold:#c8a200;
    --panel:#d4d0c8; --panel-dark:#808080; --panel-light:#ffffff; --panel-mid:#a0a0a0;
    --green:#008000; --blue:#0000a8; --yellow:#c8a200; --shadow:#00000080;

    /* Layout constants */
    --bar-h: 36px;         /* reference height for ALL bars (top & bottom) */
    --bar-pad-v: 4px;      /* consistent inner padding */
    --bar-pad-h: 8px;

    /* Derived block heights for header/footer (two bars + gap + padding) */
    --header-h: calc(var(--bar-h) * 2 + 8px + 12px);
    --footer-h: calc(var(--bar-h) * 2 + 8px + 12px);
  }
  *{box-sizing:border-box}
  html,body{height:100%; overflow:hidden;}
  body{
    margin:0; display:grid; place-items:center; color:var(--ink);
    /* One unified font everywhere (same as display) */
    font-family:"MS Sans Serif", Tahoma, Verdana, sans-serif;
    font-size:120%;               /* +20% font size across the game */
    background:var(--bg) !important; /* no gradient */
  }

  /* ===== Frame (keeps width; grows DOWN to fit viewport) ===== */
  .frame{
    position:relative;
    width:420px;                 /* same width */
    height:96vh;                 /* expand to fill screen height */
    max-width:96vw;
    background:var(--panel);
    border:2px solid var(--panel-dark);
    box-shadow: inset -1px -1px 0 var(--panel-light), inset 1px 1px 0 var(--panel-mid), 0 6px 18px var(--shadow);
    overflow:hidden;
    zoom:1.1;                    /* slight global scale to keep proportions */
  }

  /* ===== TOP: Folder Path + Message Ticker ===== */
  header{
    position:absolute; left:0; right:0; top:0; height:var(--header-h);
    z-index:3; padding:6px 8px;
    background:var(--panel); border-bottom:2px solid var(--panel-dark);
    box-shadow: inset 0 -1px 0 var(--panel-light), inset 0 1px 0 var(--panel-mid);
    display:flex; flex-direction:column; gap:8px; align-items:stretch; justify-content:center;
  }

  /* Unified “bar” style shared by all display bars */
  .bar{
    display:flex; align-items:center; gap:6px; min-width:0;
    height:var(--bar-h);
    padding:var(--bar-pad-v) var(--bar-pad-h);
    background:var(--panel); border:2px solid var(--panel-dark);
    box-shadow: inset -1px -1px 0 var(--panel-light), inset 1px 1px 0 var(--panel-mid);
    overflow:hidden;
  }

  /* Top display: smaller & bold per request */
  header .bar{ font-size:0.8em; font-weight:bold; }

  .pathbar{ /* inherits the same display font now */
    composes: bar;
    white-space:nowrap; text-overflow:ellipsis;
  }
  .pathbar span{min-width:0; overflow:hidden; text-overflow:ellipsis;}

  .ticker{
    composes: bar;
    text-transform:uppercase; color:#111;
  }
  .tickerText{white-space:nowrap; overflow:hidden; text-overflow:ellipsis;}

  /* ===== BOTTOM: HUD (Score/High/Shield + Lives/Boss HP) ===== */
  footer{
    position:absolute; left:0; right:0; bottom:0; height:var(--footer-h);
    z-index:3; padding:6px 8px 8px;
    background:var(--panel);
    border-top:2px solid var(--panel-dark);
    box-shadow: inset 0 1px 0 var(--panel-light), inset 0 -1px 0 var(--panel-mid);
    display:flex; flex-direction:column; gap:8px;
  }

  .hudRow{
    display:flex; justify-content:space-between; align-items:center; gap:8px;
  }

  .hudBlock{
    /* same height as top bars */
    height:var(--bar-h);
    flex:1; display:flex; align-items:center; gap:8px;
    padding:var(--bar-pad-v) var(--bar-pad-h);
    background:var(--panel); border:2px solid var(--panel-dark);
    box-shadow: inset -1px -1px 0 var(--panel-light), inset 1px 1px 0 var(--panel-mid);
    min-width:0;
  }
  .hudLabel{font-weight:bold; white-space:nowrap;}
  .hudValue{font-variant-numeric:tabular-nums; min-width:64px; text-align:right;}
  .hudGrow{flex:1; min-width:0;}

  /* Gauges (Shield & Boss HP) — same height everywhere */
  .gauge{
    position:relative; height:12px; width:100%;
    background:var(--panel); border:2px solid var(--panel-dark);
    box-shadow: inset -1px -1px 0 var(--panel-light), inset 1px 1px 0 var(--panel-mid);
  }
  .gauge i{
    position:absolute; inset:2px;
    background:repeating-linear-gradient(90deg,#9ad29a 0 8px,#7fb97f 8px 16px); /* shield green */
    transform-origin:left center; transform:scaleX(1);
  }
  .gauge.boss i{
    background:repeating-linear-gradient(90deg,#ff6b6b 0 8px,#d94a4a 8px 16px); /* boss red */
    transform:scaleX(0);
  }

  /* Lives */
  .lives{display:flex;align-items:center;gap:6px;}
  .life{width:12px;height:10px;background:var(--blue);
        border:2px solid var(--panel-dark);
        box-shadow:inset -1px -1px 0 var(--panel-light),inset 1px 1px 0 var(--panel-mid);}
  .ghost{opacity:.25;}

  /* Legacy boss label kept but hidden */
  .bosslabel{display:none !important;}

  /* ===== Canvas fills between header and footer (expands DOWN only) ===== */
  canvas{
    position:absolute;
    top:var(--header-h);
    bottom:var(--footer-h);        /* anchor to footer so it grows downward */
    left:16px; width:388px;        /* keep width */
    height:auto;                   /* let it stretch between top & bottom */
    background:#020409; z-index:1;
    image-rendering:pixelated; border:2px solid var(--panel-dark);
    box-shadow: inset -1px -1px 0 var(--panel-light), inset 1px 1px 0 var(--panel-mid);
  }

  /* ===== Popups (larger text; unified font inherited) ===== */
  .overlay{position:absolute; inset:0; display:flex; align-items:center; justify-content:center; z-index:5;
           background:#00000040; padding:24px;}
  .overlay.hidden{display:none;}
  .popup{
    min-width:260px; max-width:360px; background:var(--panel); color:#111;
    border:2px solid var(--panel-dark);
    box-shadow: inset -1px -1px 0 var(--panel-light), inset 1px 1px 0 var(--panel-mid), 6px 6px 0 #00000030;
    font-size:1.25em; /* bump popup body text size */
  }
  .titlebar{
    display:flex; align-items:center; justify-content:space-between; gap:8px;
    padding:6px 8px; background:var(--accent); color:#fff; font-weight:bold;
    font-size:1.1em; /* larger title */
  }
  .titlebar .controls{display:flex;gap:4px;}
  .winbtn{width:18px;height:18px;display:inline-flex;align-items:center;justify-content:center;cursor:pointer;
          background:var(--panel);color:#111;border:2px solid var(--panel-dark);
          box-shadow:inset -1px -1px 0 var(--panel-light), inset 1px 1px 0 var(--panel-mid);
          font-size:12px;line-height:1;user-select:none;}
  .content{padding:12px 14px;display:flex;flex-direction:column;gap:10px;}
  .content h1{margin:0;font-size:1.05em;}
  .content p{margin:0;font-size:1em;line-height:1.5;}
  .actions{display:flex;justify-content:flex-end;gap:10px;padding:8px 14px 14px;}
  .btn{padding:6px 12px;background:var(--panel);border:2px solid var(--panel-dark);cursor:pointer;
       font-size:1em; /* bigger button text */
       box-shadow:inset -1px -1px 0 var(--panel-light),inset 1px 1px 0 var(--panel-mid);}
  .btn:hover{filter:brightness(.95);}
  .visually-hidden{
    position:absolute!important;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0 0 0 0);border:0;
  }

  /* Hide any legacy bossbar elements if present */
  .bossbar{display:none !important;}
  
</style>
</head>
<body>
  <div id="gameRoot" class="frame">

    <!-- TOP: Folder Path + Message -->
    <header>
      <div class="pathbar bar" title="Current folder / level">
        <span id="hudLevel">—</span>
      </div>
      <div class="ticker bar">
        <span class="tickerText">PRESS START — DEFEND THE INBOX</span>
      </div>
    </header>

    <!-- Legacy label kept (hidden by CSS) -->
    <div id="bossLabel" class="bosslabel">BOSS</div>

    <!-- NOTE: Canvas CSS stretches between header/footer. The width stays fixed, height scales visually. -->
    <canvas id="game" width="388" height="420"></canvas>

    <!-- BOTTOM: HUD -->
    <footer>
      <!-- Row 1: Score, High, Shield -->
      <div class="hudRow">
        <div class="hudBlock">
          <span class="hudLabel">Score</span>
          <span id="hudScore" class="hudValue hudGrow">00000</span>
        </div>
        <div class="hudBlock">
          <span class="hudLabel">High</span>
          <span id="hudHigh" class="hudValue hudGrow">00000</span>
        </div>
        <div class="hudBlock">
          <span class="hudLabel">Shield</span>
          <div class="gauge hudGrow">
            <i id="capacityFill" style="transform:scaleX(1)"></i>
          </div>
        </div>
      </div>

      <!-- Row 2: Lives, Boss HP -->
      <div class="hudRow">
        <div class="hudBlock">
          <span class="hudLabel">You</span>
          <div id="hearts" class="lives hudGrow"></div>
        </div>
        <div class="hudBlock">
          <span class="hudLabel">Boss</span>
          <div id="bossBar" class="gauge boss hudGrow">
            <i id="bossFill" style="transform:scaleX(0)"></i>
          </div>
          <span id="hudBoss" class="visually-hidden">---</span>
        </div>
      </div>
    </footer>

    <!-- Popups -->
    <div id="start" class="overlay">
      <div class="popup" role="dialog" aria-labelledby="startTitle">
        <div class="titlebar">
          <span id="startTitle">Spam Nightmare Setup</span>
          <div class="controls"><div class="winbtn">_</div><div class="winbtn">□</div><div class="winbtn">X</div></div>
        </div>
        <div class="content">
         <h1>Welcome to the ultimate spam nightmare.</h1>
         <p>Deploy spam filters, hold the line, and defend the archive — or be consumed by the <strong>most weaponized marketing campaign ever sent.</strong> Arrow keys to move. Space to fire. Hope is optional.</p>         
        </div>
        <div class="actions"><button id="btnStart" class="btn">Start</button></div>
      </div>
        
    </div>
    

    <div id="bossIntro" class="overlay hidden">
      <div class="popup" role="dialog" aria-labelledby="bossIntroTitle">
        <div class="titlebar">
          <span id="bossIntroTitle">—</span>
          <div class="controls"><div class="winbtn">_</div><div class="winbtn">□</div><div class="winbtn">X</div></div>
        </div>
        <div class="content">
          <h1 id="bossIntroName">—</h1>
          <p>Threat detected. Press on to secure the inbox.</p>
        </div>
        <div class="actions"><button id="btnIntroOk" class="btn">Proceed</button></div>
      </div>
    </div>

    <div id="cleared" class="overlay hidden">
      <div class="popup" role="dialog">
        <div class="titlebar">
          <span>System Notice</span>
          <div class="controls"><div class="winbtn">_</div><div class="winbtn">□</div><div class="winbtn">X</div></div>
        </div>
        <div class="content">
          <h1>[ INBOX SECURED ]</h1>
          <p>Threat neutralized. System rebooting…</p>
        </div>
        <div class="actions"><button id="btnNext" class="btn">Next</button></div>
      </div>
    </div>

    <div id="gameover" class="overlay hidden">
      <div class="popup" role="dialog">
        <div class="titlebar">
          <span>Critical Alert</span>
          <div class="controls"><div class="winbtn">_</div><div class="winbtn">□</div><div class="winbtn">X</div></div>
        </div>
        <div class="content">
          <h1>[ MAILBOX LOST ]</h1>
          <p>The archive is compromised. Press Start to try again.</p>
        </div>
        <div class="actions"><button id="btnAgain" class="btn">Start Over</button></div>
      </div>
    </div>

  </div>

  <script type="module" src="./main.js"></script>
</body>
</html>
